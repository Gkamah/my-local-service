<%- include('./partials/head', { title: 'Find Local Service Providers' }) %>

    <div class="p-4 md:p-8">
        <div class="max-w-7xl mx-auto bg-white container-shadow rounded-2xl p-6">
            
            <!-- Header & Search Controls -->
            <div class="mb-8 border-b border-gray-100 pb-4">
                <h1 class="text-4xl font-extrabold text-gray-900">
                    <i class="fas fa-handshake text-indigo-600 mr-2"></i> Find Trusted Local Services
                </h1>
                <p class="text-gray-500 mt-1">Connect with verified experts in your area today.</p>

                <!-- Mock Search Bar and Filter (Aesthetic only) -->
                <div class="flex flex-col sm:flex-row gap-4 mt-4">
                    <input type="text" placeholder="Search by name, service, or keyword..."
                           class="flex-grow border border-gray-300 rounded-xl p-3 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
                    <select class="border border-gray-300 rounded-xl p-3 bg-white focus:ring-indigo-500 focus:border-indigo-500 w-full sm:w-auto">
                        <option>All Categories</option>
                        <option>Driver</option>
                        <option>Plumbing</option>
                        <option>Electrician</option>
                        <option>Gardening</option>
                        <option>Cleaning</option>
                    </select>
                    <button class="bg-indigo-600 text-white p-3 rounded-xl font-semibold hover:bg-indigo-700 transition duration-200 w-full sm:w-auto">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>
            </div>
            
            <!-- Main Content: List and Detail Split -->
            <div class="flex flex-col md:flex-row gap-8">
                
                <!-- Left Panel: Provider List (Scrollable) -->
                <div id="providerList" class="md:w-1/3 space-y-4 overflow-y-auto max-h-[75vh] pr-3">
                    <h2 class="text-xl font-bold text-gray-700 sticky top-0 bg-white z-10 py-2 border-b border-gray-100">
                        <i class="fas fa-list-ul mr-2 text-indigo-500"></i>Service Experts
                    </h2>
                    <!-- Provider cards will be rendered here -->
                </div>

                <!-- Right Panel: Detail View (The Public Profile) -->
                <div id="detailView" class="md:w-2/3 p-8 bg-indigo-50 border border-indigo-200 rounded-2xl shadow-lg min-h-[500px] flex items-center justify-center">
                    <p class="text-indigo-400 italic text-xl">
                        <i class="fas fa-arrow-left mr-2"></i>Select a provider on the left to view their detailed profile.
                    </p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // Mock Data for client-side rendering (in a real app, this would be server-rendered)
        const providers = [
            { id: 'p1', name: "Alex's Master Plumber", category: "Plumbing", rating: 4.8, reviews: 124, contactInfo: "+254 712 345 678", description: "Certified and experienced plumber specializing in emergency leak repair, pipe installation, and water heater maintenance. Available 24/7 in Nairobi area. We use modern, non-invasive techniques to ensure quick and clean fixes.", profilePictureUrl: "https://placehold.co/100x100/4f46e5/ffffff?text=AP", isVerified: true },
            { id: 'p2', name: "Sarah the Electrician", category: "Electrician", rating: 5.0, reviews: 78, contactInfo: "+254 789 012 345", description: "Providing safe and reliable residential and commercial electrical services. Wiring, lighting installation, circuit breaker fixes, and full system upgrades. Licensed and insured for your peace of mind.", profilePictureUrl: "https://placehold.co/100x100/f59e0b/ffffff?text=SE", isVerified: true },
            { id: 'p3', name: "Green Thumb Gardening", category: "Gardening", rating: 4.5, reviews: 201, contactInfo: "+254 765 432 109", description: "Professional landscaping, lawn maintenance, tree pruning, and garden design. Let us transform your outdoor space into a beautiful sanctuary. Eco-friendly methods used.", profilePictureUrl: "https://placehold.co/100x100/10b981/ffffff?text=GT", isVerified: false }
        ];

        let activeProviderId = null;

        function getStarRating(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                const starClass = i <= rating ? 'fas fa-star' : (i - 1 < rating && i > rating ? 'fas fa-star-half-alt' : 'far fa-star opacity-50');
                stars += `<i class="${starClass} review-star"></i>`;
            }
            return stars;
        }

        function renderProviders() {
            const listContainer = document.getElementById('providerList');
            let html = '';

            providers.forEach(provider => {
                const isActive = provider.id === activeProviderId ? 'active' : '';
                html += `
                    <div class="provider-card p-4 bg-white shadow-md rounded-xl flex items-center gap-4 ${isActive}" 
                         onclick="viewDetails('${provider.id}', this)">
                        <img src="${provider.profilePictureUrl}" 
                             alt="${provider.name}" 
                             class="w-16 h-16 rounded-full object-cover border-3 border-gray-200 flex-shrink-0">
                        <div class="flex-grow min-w-0">
                            <h3 class="text-lg font-semibold text-gray-900 truncate">${provider.name}</h3>
                            <p class="text-sm text-gray-600 flex items-center mb-1">
                                <i class="fas fa-tools mr-1 text-indigo-500 text-xs"></i>${provider.category}
                            </p>
                            <div class="text-sm text-gray-700">
                                ${getStarRating(provider.rating)}
                                <span class="font-bold ml-1">${provider.rating}</span> 
                                <span class="text-xs text-gray-500">(${provider.reviews} reviews)</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            listContainer.innerHTML += html;
        }

        function viewDetails(id, element) {
            const provider = providers.find(p => p.id === id);
            const detailContainer = document.getElementById('detailView');
            
            document.querySelectorAll('.provider-card').forEach(card => card.classList.remove('active'));
            if (element) {
                element.classList.add('active');
            }
            activeProviderId = id;

            if (provider) {
                detailContainer.innerHTML = `
                    <div class="w-full">
                        <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-8 mb-8 pb-6 border-b border-indigo-200">
                            <img src="${provider.profilePictureUrl}" 
                                 alt="${provider.name}'s Profile Picture" 
                                 class="w-32 h-32 rounded-full object-cover border-4 border-indigo-300 shadow-xl flex-shrink-0">
                            <div>
                                <h2 class="text-4xl font-extrabold text-gray-900">${provider.name}</h2>
                                <p class="text-xl text-indigo-700 font-semibold flex items-center mt-1">
                                    <i class="fas fa-certificate mr-2 text-yellow-500"></i> ${provider.category} Expert
                                </p>
                                <div class="mt-2 flex items-center space-x-2">
                                    <div class="text-xl">
                                        ${getStarRating(provider.rating)}
                                    </div>
                                    <span class="text-2xl font-bold text-gray-800">${provider.rating}</span> 
                                    <span class="text-gray-500 text-base">(${provider.reviews} reviews)</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-8">
                            <section>
                                <h3 class="text-2xl font-bold text-indigo-800 mb-3 border-l-4 border-indigo-500 pl-3">
                                    <i class="fas fa-info-circle mr-2"></i>About Our Service
                                </h3>
                                <p class="text-gray-700 leading-relaxed bg-white p-5 rounded-xl shadow-lg border border-gray-100">
                                    ${provider.description}
                                </p>
                            </section>
                            
                            <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div class="bg-indigo-100 p-5 rounded-xl shadow-md">
                                    <h3 class="text-xl font-bold text-indigo-800 mb-3">
                                        <i class="fas fa-phone-volume mr-2"></i>Direct Contact
                                    </h3>
                                    <p class="text-gray-700 font-medium">
                                        <strong>Phone/WhatsApp:</strong> 
                                        <span class="text-indigo-600">${provider.contactInfo}</span>
                                    </p>
                                    <p class="text-gray-600 mt-1">
                                        <i class="fas fa-map-marker-alt mr-2"></i>Serving the Nairobi Area
                                    </p>
                                </div>
                                <div class="bg-green-100 p-5 rounded-xl shadow-md">
                                    <h3 class="text-xl font-bold text-green-800 mb-3">
                                        <i class="fas fa-check-circle mr-2"></i>Verification Status
                                    </h3>
                                    <p class="text-gray-700 flex items-center">
                                        ${provider.isVerified ? 
                                            '<span class="text-green-600 font-semibold"><i class="fas fa-shield-alt mr-2"></i> Verified & Background Checked</span>' :
                                            '<span class="text-yellow-600 font-semibold"><i class="fas fa-clock mr-2"></i> Pending Verification</span>'
                                        }
                                    </p>
                                </div>
                            </section>
                            
                            <button class="w-full py-4 btn-primary text-white font-extrabold rounded-xl text-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-[1.01] shadow-lg">
                                <i class="fas fa-calendar-check mr-3"></i> Request a Quote or Book Now
                            </button>
                        </div>
                    </div>
                `;
            } else {
                detailContainer.innerHTML = '<p class="text-indigo-400 italic text-xl">Provider details not found.</p>';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderProviders();
            if (providers.length > 0) {
                const firstCard = document.querySelector('.provider-card');
                if (firstCard) {
                    viewDetails(providers[0].id, firstCard);
                }
            }
        });
    </script>
</body>
</html>
